<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hasil Ujian - PERGUNU SITUBONDO</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <div id="particles-js"></div>
    <div class="container">
        <div class="result-box slide-in">
            <h1>Hasil Ujian Anda</h1>
            
            <div id="result-details">
                <!-- Result details will be loaded by JavaScript -->
            </div>
            
            <div class="result-actions">
                <button id="view-certificate" class="btn-gradient">
                    <i class="fas fa-certificate"></i> Lihat Sertifikat
                </button>
                <button id="retake-exam" class="btn-outline">
                    <i class="fas fa-redo"></i> Ulangi Ujian
                </button>
            </div>
        </div>
    </div>
    
    <!-- Floating Buttons -->
    <div class="floating-buttons">
        <button class="floating-btn share-btn" title="Bagikan">
            <i class="fas fa-share-alt"></i>
        </button>
        <button class="floating-btn whatsapp-btn" title="Chat Admin">
            <i class="fab fa-whatsapp"></i>
        </button>
    </div>
    
    <audio id="applause-audio" src="../assets/audio/applause.mp3" preload="auto"></audio>
    
    <script src="../assets/js/particles.js"></script>
    <script src="../assets/js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Load exam result
            const examResult = JSON.parse(sessionStorage.getItem('examResult'));
            const resultDetails = document.getElementById('result-details');
            
            // Play applause sound
            document.getElementById('applause-audio').play().catch(e => console.log("Audio play prevented:", e));
            
            // Display result
            resultDetails.innerHTML = `
                <div class="result-summary">
                    <h2>${examResult.examTitle}</h2>
                    <div class="score-circle">
                        <div class="score-value">${examResult.score}</div>
                        <div class="score-label">Nilai</div>
                    </div>
                </div>
                
                <div class="result-stats">
                    <div class="stat-item correct-stat">
                        <div class="stat-value">${examResult.correctAnswers}</div>
                        <div class="stat-label">Jawaban Benar</div>
                    </div>
                    
                    <div class="stat-item wrong-stat">
                        <div class="stat-value">${examResult.wrongAnswers}</div>
                        <div class="stat-label">Jawaban Salah</div>
                    </div>
                    
                    <div class="stat-item unanswered-stat">
                        <div class="stat-value">${examResult.unanswered}</div>
                        <div class="stat-label">Tidak Dijawab</div>
                    </div>
                </div>
                
                <div class="motivational-message">
                    <p>${getMotivationalMessage(examResult.score)}</p>
                </div>
            `;
            
            // View certificate button
            document.getElementById('view-certificate').addEventListener('click', function() {
                window.location.href = 'certificate.html';
            });
            
            // Retake exam button
            document.getElementById('retake-exam').addEventListener('click', function() {
                window.location.href = 'exam-selection.html';
            });
            
            // Get motivational message based on score
            function getMotivationalMessage(score) {
                const messages = JSON.parse(localStorage.getItem('motivationalMessages')) || [
                    { min: 0, max: 40, message: "Jangan menyerah! Teruslah belajar dan tingkatkan pemahaman Anda." },
                    { min: 41, max: 60, message: "Hasil yang cukup baik, tapi masih ada ruang untuk perbaikan." },
                    { min: 61, max: 80, message: "Kerja bagus! Anda telah menunjukkan pemahaman yang baik." },
                    { min: 81, max: 99, message: "Luar biasa! Hampir sempurna, pertahankan prestasi ini." },
                    { min: 100, max: 100, message: "Sempurna! Anda sangat luar biasa dalam menguasai materi ini." }
                ];
                
                const defaultMessage = "Terima kasih telah mengikuti ujian ini. Hasil Anda telah tercatat.";
                
                const matchedMessage = messages.find(msg => score >= msg.min && score <= msg.max);
                return matchedMessage ? matchedMessage.message : defaultMessage;
            }
        });
    </script>
</body>
</html>
