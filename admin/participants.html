<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peserta Ujian - Ujian Online PERGUNU</title>
    <link rel="stylesheet" href="../../assets/css/style.css">
    <style>
        .participants-filter {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .filter-group {
            flex: 1;
        }
        
        .participants-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .participants-table th, .participants-table td {
            padding: 0.8rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .participants-table th {
            background: #f5f7fa;
            font-weight: 600;
        }
        
        .participants-table tr:hover {
            background: #f5f7fa;
        }
        
        .participant-status {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-completed {
            background: #E8F5E9;
            color: #2E7D32;
        }
        
        .status-inprogress {
            background: #FFF8E1;
            color: #FF8F00;
        }
        
        .status-failed {
            background: #FFEBEE;
            color: #C62828;
        }
        
        .export-buttons {
            margin-top: 1rem;
            display: flex;
            gap: 1rem;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 1.5rem;
            gap: 0.5rem;
        }
        
        .page-item {
            padding: 0.5rem 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .page-item.active {
            background: #4e54c8;
            color: white;
            border-color: #4e54c8;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-sidebar">
            <div class="admin-logo">
                <img src="../../assets/images/logo.png" alt="PERGUNU SITUBONDO">
            </div>
            
            <ul class="admin-menu">
                <li><a href="../index.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="../questions.html"><i class="fas fa-book"></i> Bank Soal</a></li>
                <li><a href="#" class="active"><i class="fas fa-users"></i> Peserta Ujian</a></li>
                <li><a href="#"><i class="fas fa-lock"></i> Pengaturan Kode</a></li>
                <li><a href="#"><i class="fas fa-cog"></i> Pengaturan Ujian</a></li>
                <li><a href="#"><i class="fas fa-certificate"></i> Pengaturan Sertifikat</a></li>
                <li><a href="#"><i class="fas fa-edit"></i> Konten Website</a></li>
                <li><a href="../../index.html"><i class="fas fa-sign-out-alt"></i> Keluar</a></li>
            </ul>
        </div>
        
        <div class="admin-content">
            <div class="admin-header">
                <h1 class="admin-title">Daftar Peserta Ujian</h1>
                <div class="admin-actions">
                    <button class="btn-admin" id="refresh-participants"><i class="fas fa-sync-alt"></i> Refresh</button>
                </div>
            </div>
            
            <div class="admin-card">
                <div class="participants-filter">
                    <div class="filter-group">
                        <label>Status Peserta</label>
                        <select id="status-filter">
                            <option value="all">Semua</option>
                            <option value="completed">Selesai</option>
                            <option value="inprogress">Dalam Proses</option>
                            <option value="failed">Gagal</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Jenis Ujian</label>
                        <select id="exam-type-filter">
                            <option value="all">Semua</option>
                            <option value="pelajar">Pelajar</option>
                            <option value="umum">Umum</option>
                            <option value="cpns">CPNS/P3K</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Tanggal</label>
                        <input type="date" id="date-filter">
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="participants-table">
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Status</th>
                                <th>Jenis Ujian</th>
                                <th>Mata Ujian</th>
                                <th>Skor</th>
                                <th>Tanggal</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="participants-list">
                            <!-- Participants will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination">
                    <div class="page-item active">1</div>
                    <div class="page-item">2</div>
                    <div class="page-item">3</div>
                    <div class="page-item">...</div>
                    <div class="page-item">10</div>
                </div>
                
                <div class="export-buttons">
                    <button class="btn-admin"><i class="fas fa-file-word"></i> Export ke Word</button>
                    <button class="btn-admin"><i class="fas fa-file-excel"></i> Export ke Excel</button>
                    <button class="btn-admin"><i class="fas fa-file-pdf"></i> Export ke PDF</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../../assets/js/admin.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Load participants
            loadParticipants();
            
            // Filter participants
            document.getElementById('status-filter').addEventListener('change', loadParticipants);
            document.getElementById('exam-type-filter').addEventListener('change', loadParticipants);
            document.getElementById('date-filter').addEventListener('change', loadParticipants);
            
            // Refresh button
            document.getElementById('refresh-participants').addEventListener('click', loadParticipants);
            
            // Load participants function
            function loadParticipants() {
                const statusFilter = document.getElementById('status-filter').value;
                const examTypeFilter = document.getElementById('exam-type-filter').value;
                const dateFilter = document.getElementById('date-filter').value;
                
                // In a real app, this would be fetched from a database
                // Here we use localStorage for demonstration
                const participants = JSON.parse(localStorage.getItem('participants')) || [];
                
                // Filter participants
                let filteredParticipants = participants;
                
                if (statusFilter !== 'all') {
                    filteredParticipants = filteredParticipants.filter(p => p.status === statusFilter);
                }
                
                if (examTypeFilter !== 'all') {
                    filteredParticipants = filteredParticipants.filter(p => p.examType === examTypeFilter);
                }
                
                if (dateFilter) {
                    filteredParticipants = filteredParticipants.filter(p => p.date === dateFilter);
                }
                
                // Display participants
                const participantsList = document.getElementById('participants-list');
                participantsList.innerHTML = '';
                
                if (filteredParticipants.length === 0) {
                    participantsList.innerHTML = '<tr><td colspan="7" style="text-align: center;">Tidak ada peserta yang sesuai dengan filter</td></tr>';
                    return;
                }
                
                filteredParticipants.forEach(participant => {
                    const row = document.createElement('tr');
                    
                    let statusClass = '';
                    let statusText = '';
                    
                    if (participant.status === 'completed') {
                        statusClass = 'status-completed';
                        statusText = 'Selesai';
                    } else if (participant.status === 'inprogress') {
                        statusClass = 'status-inprogress';
                        statusText = 'Dalam Proses';
                    } else {
                        statusClass = 'status-failed';
                        statusText = 'Gagal';
                    }
                    
                    row.innerHTML = `
                        <td>${participant.name}</td>
                        <td><span class="participant-status ${statusClass}">${statusText}</span></td>
                        <td>${participant.examType === 'pelajar' ? 'Pelajar' : participant.examType === 'umum' ? 'Umum' : 'CPNS/P3K'}</td>
                        <td>${participant.examSubject || '-'}</td>
                        <td>${participant.score || '-'}</td>
                        <td>${participant.date}</td>
                        <td>
                            <button class="btn-small btn-edit" data-id="${participant.id}"><i class="fas fa-eye"></i> Lihat</button>
                        </td>
                    `;
                    
                    participantsList.appendChild(row);
                });
                
                // Add event listeners to view buttons
                document.querySelectorAll('.btn-edit').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const participantId = this.getAttribute('data-id');
                        viewParticipant(participantId);
                    });
                });
            }
            
            // View participant function
            function viewParticipant(participantId) {
                const participants = JSON.parse(localStorage.getItem('participants')) || [];
                const participant = participants.find(p => p.id === participantId);
                
                if (!participant) {
                    alert('Peserta tidak ditemukan');
                    return;
                }
                
                alert(`Detail Peserta:\n\nNama: ${participant.name}\nStatus: ${participant.status}\nJenis Ujian: ${participant.examType}\nSkor: ${participant.score || '-'}\nTanggal: ${participant.date}`);
            }
        });
    </script>
</body>
</html>
